const request = require('request');
const fs = require('fs');
const https = require('https');

// HTTPS Agent
const agentOptions = {
  // Add any necessary agent options (like certificates, etc.) here.
};
const agent = new https.Agent(agentOptions);

// Function to download the file asynchronously
function downloadFile(url, filePath) {
  return new Promise((resolve, reject) => {
    const file = fs.createWriteStream(filePath);

    request
      .get({
        url: url,
        agent: agent
      })
      .pipe(file)
      .on('finish', () => {
        resolve('File downloaded successfully.');
      })
      .on('error', (err) => {
        reject('Error downloading file: ' + err);
      });
  });
}

// Usage with async/await
async function asyncDownload() {
  try {
    const message = await downloadFile('https://example.com/sample.pdf', 'sample.pdf');
    console.log(message);
  } catch (error) {
    console.error(error);
  }
}

asyncDownload();
