import os
import csv

# Define the root directory containing folders with CSV files
root_dir = "path/to/your/folder"  # Change this to your directory path

# Output text file
output_file = "extracted_languages.txt"

# Open the output file in write mode
with open(output_file, "w") as out_file:
    # Walk through all directories and files
    for foldername, subfolders, filenames in os.walk(root_dir):
        for filename in filenames:
            if filename.endswith(".csv"):  # Process only CSV files
                file_path = os.path.join(foldername, filename)
                
                # Open and read the CSV file
                with open(file_path, "r", newline='', encoding="utf-8") as csvfile:
                    reader = csv.reader(csvfile)
                    for row in reader:
                        if len(row) > 1:  # Ensure the row has at least two columns
                            out_file.write(row[1] + "\n")  # Write second column to file

print("Extraction completed. Check", output_file)
